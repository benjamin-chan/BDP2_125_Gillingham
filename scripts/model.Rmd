# Model

Parameters.

* `genotype` is wild type `WT` or knockout `KO`
* `activity` is `rest` or `exhaustive`
* `n` is the number of mice per (`genotype`, `activity`)
* `m` is the number of metabolites
* `j` is number of metabolite types
* `k` is number of metabolites per type
* `rho1` is the within-metabolite correlation
* `rho2` is the between-metabolite correlation


## Aim 1: Exercise

**Rest versus exhaustive exercise**

Estimate model.
Default to `correlation = NULL`, corresponding to no within-group correlations.

```{r}
fixed <- formula(value ~
                   genotype +
                   activity +
                   metabolite_type +
                   genotype * activity +
                   genotype * metabolite_type)
random <- formula(~ 1 | id)
M <- lme(fixed, data = D1, random = random, correlation = NULL)
summary(M)
```

Estimate model.
Specify the correlation structure using `cs`.
Use `corCompSymm`, *compound symmetry structure corresponding to a constant correlation*.

```{r}
cs <-
  corCompSymm(form = random, fixed = FALSE) %>%
  Initialize(data = D1)
Dim(cs)
M <- lme(fixed, data = D1, random = random, correlation = cs)
summary(M)
```


## Aim 2: Chow

**MCT chow versus experimental chow with truheptanoin**

Estimate model.
Default to `correlation = NULL`, corresponding to no within-group correlations.

```{r}
fixed <- formula(value ~
                   genotype +
                   chow +
                   metabolite_type +
                   genotype * chow +
                   genotype * metabolite_type)
random <- formula(~ 1 | id)
M <- lme(fixed, data = D2, random = random, correlation = NULL)
summary(M)
```

Estimate model.
Specify the correlation structure using `cs`.
Use `corCompSymm`, *compound symmetry structure corresponding to a constant correlation*.

```{r}
cs <-
  corCompSymm(form = random, fixed = FALSE) %>%
  Initialize(data = D2)
Dim(cs)
M <- lme(fixed, data = D2, random = random, correlation = cs)
summary(M)
```
