# Read data

Import the data.
Data files are locally stored.

Import Aim 1: Exercise data

```{r}
L1 <- importDataToList("../data/raw/Ultragenyx Aim 1 Z score.xlsx")
L1[["file"]]
L1[["dim"]]
L1[["names"]]
L1[["head"]]
D1 <- L1[["data"]]
```

Import Aim 2: Diet data.
Metabolite `LCAC total` is the sum of `LC even AC total` and `LC odd AC total`; remove `LCAC total` data.

```{r}
L2 <- importDataToList("../data/raw/Ultragenyx Aim 2 Z score.xlsx")
L2[["file"]]
L2[["dim"]]
L2[["names"]]
L2[["head"]]
D2 <- L2[["data"]] %>% filter(metabolite != "LCAC total")
```


## Check data

Check the `value` and `logValue`.

```{r densitiesAim1, results = "asis", fig.height = 6, fig.width = 12}
kable(summarizeOutcome(D1))
ggplot(D1) +
  aes(x = logValue, color = metabolite_type, fill = metabolite_type) +
  geom_density(alpha = 1/3) +
  scale_x_continuous("log10 scale") +
  facet_grid(genotype ~ activity) +
  scale_color_brewer("Metabolite type", palette = "Set1") +
  scale_fill_brewer("Metabolite type", palette = "Set1") +
  theme_bw()
```

```{r densitiesAim2, results = "asis", fig.height = 6, fig.width = 12}
kable(summarizeOutcome(D2))
ggplot(D2) +
  aes(x = logValue, color = metabolite_type, fill = metabolite_type) +
  geom_density(alpha = 1/3) +
  scale_x_continuous("log10 scale") +
  facet_grid(genotype ~ chow) +
  scale_color_brewer("Metabolite type", palette = "Set1") +
  scale_fill_brewer("Metabolite type", palette = "Set1") +
  theme_bw()
```


Check fixed effects factors.

```{r}
D1 %>% group_by(genotype, activity) %>% tally
D1 %>% group_by(genotype, metabolite) %>% tally
D1 %>% group_by(activity, metabolite) %>% tally
```

```{r}
D2 %>% group_by(genotype, chow) %>% tally
D2 %>% group_by(genotype, metabolite) %>% tally
D2 %>% group_by(chow, metabolite) %>% tally
```
